<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.40.2" />
  <meta name="author" content="Newres Al Haider">

  
  
  
  
    
      
    
  
  <meta name="description" content="Spider-Man is one of the most iconic heroes of the Marvel universe. Created by Stan Lee and Steve Ditko, Spider-Man is a regular teenager named Peter Parker, who due to being bitten by a radio-active spider, gains abilities such as the proportional strength of a spider, wall crawling and a spider sense to detect upcoming danger. One of the biggest draws of Spider-Man that although he is a superhero and fought various villains from cosmic beings to petty criminals, he also had to deal with regular everyday problems, such as money issues, school life and the pressure of a job.">

  
  <link rel="alternate" hreflang="en-us" href="/post/spec-stacular-spider-man/">

  


  

  
  
  <meta name="theme-color" content="#0095eb">
  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  

  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Newres Al Haider">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="Newres Al Haider">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/spec-stacular-spider-man/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@newresa">
  <meta property="twitter:creator" content="@newresa">
  
  <meta property="og:site_name" content="Newres Al Haider">
  <meta property="og:url" content="/post/spec-stacular-spider-man/">
  <meta property="og:title" content="Spec-stacular Spider-Man | Newres Al Haider">
  <meta property="og:description" content="Spider-Man is one of the most iconic heroes of the Marvel universe. Created by Stan Lee and Steve Ditko, Spider-Man is a regular teenager named Peter Parker, who due to being bitten by a radio-active spider, gains abilities such as the proportional strength of a spider, wall crawling and a spider sense to detect upcoming danger. One of the biggest draws of Spider-Man that although he is a superhero and fought various villains from cosmic beings to petty criminals, he also had to deal with regular everyday problems, such as money issues, school life and the pressure of a job.">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-04-29T00:00:00&#43;02:00">
  
  <meta property="article:modified_time" content="2018-05-01T00:00:00&#43;02:00">
  

  

  <title>Spec-stacular Spider-Man | Newres Al Haider</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">Newres Al Haider</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#publications_selected">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">Spec-stacular Spider-Man</h1>

    

<div class="article-metadata">

  <span class="article-date">
    
        Last updated on
    
    <time datetime="2018-04-29 00:00:00 &#43;0200 CEST" itemprop="datePublished dateModified">
      1 May, 2018
    </time>
  </span>
  <span itemscope itemprop="author publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Newres Al Haider">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    14 min read
  </span>
  

  
  

  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Spec-stacular%20Spider-Man&amp;url=%2fpost%2fspec-stacular-spider-man%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2fspec-stacular-spider-man%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2fspec-stacular-spider-man%2f&amp;title=Spec-stacular%20Spider-Man"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2fspec-stacular-spider-man%2f&amp;title=Spec-stacular%20Spider-Man"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Spec-stacular%20Spider-Man&amp;body=%2fpost%2fspec-stacular-spider-man%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


    <div class="article-style" itemprop="articleBody">
      <p>Spider-Man is one of the most iconic heroes of the Marvel universe. Created by Stan Lee and Steve Ditko, Spider-Man is a regular teenager named Peter Parker, who due to being bitten by a radio-active spider, gains abilities such as the proportional strength of a spider, wall crawling and a spider sense to detect upcoming danger. One of the biggest draws of Spider-Man that although he is a superhero and fought various villains from cosmic beings to petty criminals, he also had to deal with regular everyday problems, such as money issues, school life and the pressure of a job.</p>


<figure>
    
        <img src="/img/post/2018-04/spec-stacular-spider-man/spectacular-spider-man.jpg" />
    
    
    <figcaption>
        <h4>The Spectacular Spider-Man Â© Marvel Entertainment</h4>
        
    </figcaption>
    
</figure>


<p>In software there are also everyday problems which one has to tackle before one can defeat the villains of the domain at hand. One of these everyday problems is the issue of data validation. Data validation is the process of ensuring that the elements of the data are correct. This process has to be done in pretty much all domains when working with actual data. Consider the financial domain where a financial product can only be made available if the right requirements are fulfilled in the request. If the request is not written correctly then the request needs to be denied. In the legal and regulatory domains certain information that is required for a law must be fulfilled, otherwise costly corrections or fines can follow. Another good example is the clinical domain, where the a patients data needs to be transferred to an application. Here is it essential that this data fulfills the requirement for requesting a clinical procedure or a medication, as any mistake can lead to huge negative impact on the health of the patient.</p>

<p>One relatively recent tool that can be used to solve this problem is the <a href="https://clojure.org/guides/spec" target="_blank">clojure.spec</a> library in the Clojure programming language. In this article we aim to explain, alongside Spider-Man, how these specs can be used to tackle the data validation problem in a spectacular way. As this library relies on the Clojure language some knowledge of Clojure is needed. In order to make this article understandable to those without such prior expertise we introduce some aspects of Clojure. In particular we focus on two features of it: the way information (data) is represented and the fact that it is a Lisp.</p>

<p>In Clojure data is represented with relatively few elements that are combined together. Take for example a scenario where we want to create a profile of Spider-Man, as taken from the Marvel wiki entry on <a href="http://marvel.com/universe/Spider-Man_(Peter_Parker)" target="_blank">Spider-Man</a>.</p>

<p>The full name of Spider-Man can be represented in text form as a string. Like in many other languages the text is placed in between quotation marks.</p>

<pre><code class="language-clojure">&quot;Peter Benjamin Parker&quot;
</code></pre>

<p>For the numbers to represent his relative power in the Marvel universe, we use natural numbers (we leave the concepts and issues surrounding very large or floating point numbers out in this article). In case of Spider-Man his durability is 5:</p>

<pre><code class="language-clojure">5
</code></pre>

<p>Of course having just a value of the name and the durability of Spider-Man just floating around makes the representation somewhat incomplete, as they are not attached to the concepts of &ldquo;name&rdquo; or &ldquo;durability&rdquo;. Just like how Spider-Man needs buildings to sling off of, we need a representation that links the values with what they represent. In Clojure, keywords are often used for this purpose.</p>

<pre><code class="language-clojure">:real-name
</code></pre>

<pre><code class="language-clojure">:spider-man-spec.core/name
</code></pre>

<pre><code class="language-clojure">::durability
</code></pre>

<p>Keywords are symbolic identifiers. Think of them as symbols, much like one would use a string, but with some special powers attached. They are text prefaced by &ldquo;:&ldquo;, as it can be seen in the keyword <code>:real-name</code>. They have the ability to be namespace-qualified, such as <code>:spider-man-spec.core/name</code> which indicates that this is the keyword in the <code>spider-man-spec.core</code> namespace. Namespaces are what allows us to modularize our data and code, by grouping them under together a single identifier. In our case this is <code>spider-man-spec.core</code>. This namespacing ensures that our definition of the concepts of &ldquo;name&rdquo;, &ldquo;real-name&rdquo;, &ldquo;durability&rdquo;, etc. can remain distinct from any other use of similar concepts. Finally, when writing internally to the library which uses the namespace, or when aliasing to it, we can just shorten the keyword with &ldquo;::&ldquo;, such as in <code>::durability</code>.</p>

<p>Keywords come with some nice implementation details, such as fast equality checks and some other powers we will show in the future. This makes them the preferred keys in data-structures such as maps. And speaking of maps they allow the description of information in key-value pairs, as written between curly braces in the small example below.</p>

<pre><code class="language-clojure">  {::name &quot;Spider-Man&quot;
   ::real-name &quot;Peter Benjamin Parker&quot;}
</code></pre>

<p>The curly backets around the pairs express the keys and values in a map in Clojure. In the above example <code>::name</code> and <code>::real-name</code> are the key and value pairs for <code>&quot;Spider-Man&quot;</code> and <code>&quot;Peter Benjamin Parker&quot;</code> respectively.</p>

<p>Maps are just one of the ways one can describe a collection of elements. You also have sets, collections in which each element is unique. This can be done with a hashtag and some curly brackets &ldquo;#{}&rdquo;. In the example below we list the current and former affiliations of Spider-Man.</p>

<pre><code class="language-clojure">{::current-affiliations #{&quot;Avengers&quot;}
 ::former-affiliations #{&quot;Secret Defenders&quot; &quot;New Fantastic Four&quot; &quot;The Outlaws&quot;}}
</code></pre>

<p>Note that how sets are used within maps to represent this knowledge. This is actually a common way to represent knowledge in Clojure: you combine all the various data representations directly. This way you can have a list containing maps, with keywords as keys and values that contain maps and strings, where the maps contain numbers, etc. You have these data-structures in pretty much all commonly used programming languages. Where Clojure differs from many is that it does not put (almost any) sugaring or abstraction on top.</p>


<figure>
    
        <img src="/img/post/2018-04/spec-stacular-spider-man/spider-man-swinging.jpg" />
    
    
    <figcaption>
        <h4>Spider-Man swinging around the city. Â© Marvel Studios</h4>
        
    </figcaption>
    
</figure>


<p>Just as Spider-Man is often at his best when he is just being &ldquo;plain old Spidey&rdquo;, having data represented this way has some nice advantages. The biggest is simplicity. Instead of learning to work with specific wrappers, objects, prototypes, etc on top of this data, that can differ between applications and libraries, it is enough to learn how to handle and manipulate maps, list, sets once. This knowledge can be then reused in any domain, and frees up the attention of the programmer to focus on the domain problem, and not the exact way the data was wrapped up in a library.</p>

<p>This of course also means that a system, such as clojure.spec, that aims at data validation in Clojure, has to handle the above-mentioned style of composition well. But before we get ahead of ourselves lets finish up by providing the profile of Spider Man.</p>

<pre><code class="language-clojure">(def spider-man-profile
  {::name &quot;Spider-Man&quot;
   ::real-name &quot;Peter Benjamin Parker&quot;
   ::identity ::secret
   ::affiliations
                   {::current-affiliations #{&quot;Avengers&quot;}
                    ::former-affiliations #{&quot;Secret Defenders&quot; &quot;New Fantastic Four&quot; &quot;The Outlaws&quot;}}
   ::power-grid {
                 ::durability 3
                 ::energy 4
                 ::fighting 5
                 ::intelligence 4
                 ::speed 5
                 ::strength 4
                 }
   }
  )


(def vulture-profile
  {::name &quot;Vulture&quot;
   ::real-name &quot;Adrian Toomes&quot;
   ::identity ::publicly-known
   ::affiliations
                   {::current-affiliations {}
                    ::former-affiliations #{&quot;Sinister Twelve&quot; &quot;Sinister Six&quot;}}
   ::power-grid {
                 ::durability 4
                 ::energy 3
                 ::fighting 4
                 ::intelligence 4
                 ::speed 5
                 ::strength 3
                 }
   }
  )

(def spider-man-characters [spider-man-profile vulture-profile])
</code></pre>

<p>Oh no, our Spider Senses should be tingling. It is Vulture, that has shown up in our list of Spider-Man characters. In addition we just introduced some new elements in our example that need some explanation for readers new to Clojure.</p>


<figure>
    
        <img src="/img/post/2018-04/spec-stacular-spider-man/vulture.jpg" />
    
    
    <figcaption>
        <h4>Uh oh, Vulture must be up to no good if he shows up here. Â© Marvel Studios</h4>
        
    </figcaption>
    
</figure>


<p>The first is the use of square brackets [], which indicate a list. This is a collection of elements, in this case of <code>spider-man-profile</code> and <code>vulture-profile</code>, that unlike a set, can have multiples of the same element.</p>

<p>The other new type of element we use is the form of using parentheses along side def as in <code>(def spider-man-characters ...)</code>. Expressions of these type, called symbolic expressions, or s-expressions for short, are a characteristic of the Lisp family of languages to which Clojure belongs to. In a Lisp, parts of the program are either atoms, such as <code>5</code>, <code>&quot;Peter Benjamin Parker&quot;</code>, <code>true</code>, or an s-expression where the first element between parens is a function and the rest are parameters. For example <code>(+ 1 3)</code>. While atoms evaluate to themselves, the s-expressions evaluate to a function with the given parameters. In the case of <code>(+ 1 3)</code> they should evaluate to <code>4</code>. You can also nest s-expressions, such as <code>(- (+ 1 3) 2)</code>, which will evaluate to <code>2</code>.</p>

<p>You might be thinking, &ldquo;Wait, if everything is either an atom or an s-expression, what kind of villainous things are those strange brackets that one has to use to create a set, list or map!&rdquo;. For all the simplicity in Clojure, it does make use of some syntactical sugar. Lists can be written <code>[spider-man-profile vulture-profile]</code> as a shorthand for the s-expression <code>(list spider-man-profile vulture-profile)</code>. Similar functions exist for maps and sets as well.</p>

<p>Much like Spider-Man, who for all his powers still has to struggle with juggling a school and a job and has to make practical decisions, Clojure has to make them as well. In this case because certain things, such as maps, sets and list are used so often, it uses a shorter syntax for creating them. This does makes the language slightly more complex, but in the author&rsquo;s view, it pays off.</p>

<p>Another matter of practicality of course is that while we can nest the two profiles directly into a list, we can create variables for them to associate. The <code>def</code> function does exactly this, and it also ensures they become part of the current namespace. For example, if the current namespace is <code>spider-man-spec.core</code> then a <code>def</code> of <code>vulture-profile</code> can be referred to as <code>spider-man-spec.core/vulture-profile</code> from other namespaces, and simply <code>vulture-profile</code> in the current namespace. This allows us to break up the overall data in smaller parts to use.</p>

<p>Now we finally described the profiles of both Spider-Man and Vulture, but are they correct? The library of clojure.spec uses the notion of a spec for this. A spec is simply a function on a single parameter that returns a truthy value (in most cases a <code>true</code> if the spec holds, <code>false</code> if the spec does not hold).</p>

<p>In essence this allows for many existing functions to be used as specs. For example the already existing function <code>string?</code> checks whether a particular value is a string or not.</p>

<p>In order to check whether a value is valid for a particular spec we can use the <code>s/valid?</code> function. Here the <code>s</code> stands the namespace of the spec library <code>clojure.spec.alpha</code>, so by calling <code>s/valid?</code> we are calling the <code>valid?</code> function of this particular namespace.</p>

<pre><code class="language-clj">(s/valid? string? &quot;Spider-Man&quot;)
</code></pre>

<p>The above function call will checking if <code>&quot;Spider-Man&quot;</code> is indeed a string, and return <code>true</code> if it is. On the other hand if we check whether a number is valid for this spec, using <code>(s/valid? string? 6)</code> we instead get <code>false</code> returned.</p>

<p>Another way to use a spec, is to explain why a value is wrong. For example, we can call the function <code>explain-data</code> on with the spec and an incorrect value, to get a map back with an explanation. The function call:</p>

<pre><code class="language-clj">(s/explain-data string? 6)
</code></pre>

<p>would result in the map:</p>

<pre><code class="language-clj">{:val 6 :predicate :clojure.spec.alpha/unknown}
</code></pre>

<p>Now the above example clearly shows the value on which the spec has failed, but it denotes the predicate as unknown with <code>:clojure.spec.alpha/unknown</code>. The solution to this is to provide a name for the spec, which the system can use to pin point if things fail. We can register any spec using the function <code>s/def</code>. For example the functions:</p>

<pre><code class="language-clj">(s/def ::name string?)

(s/def ::real-name string?)
</code></pre>

<p>will register the two specs under the keys <code>:name</code> and <code>:real-name</code> in the current namespace, i.e.: under <code>spider-man-spec.core/name</code> and <code>spider-man-spec.core/name</code> respectively.</p>

<p>Now if we would aim to explain why the spec <code>:real-name</code>  does not allow the value <code>6</code>, it would return the explanation:</p>

<pre><code class="language-clj">{:val 6 :predicate :spider-man-spec.core/real-name}
</code></pre>

<p>where the predicate now identifies the spec that was not fulfilled.</p>

<p>Specs can also be created in other ways. For example a set of values indicating the correct values can be used as a spec.</p>

<pre><code class="language-clj">(s/def ::identity #{::secret ::publicly-known})
</code></pre>

<p>The above code defines a spec for identity as having two possible values: either <code>::secret</code> or <code>::publicly-known</code>.</p>

<p>Specs can also be defined for collections as well. The specs for current- and former affiliations:</p>

<pre><code class="language-clj">(s/def ::current-affilications (s/coll-of string? :kind set?))

(s/def ::former-affilications (s/coll-of string? :kind set?))
</code></pre>

<p>These specs describe that that both current- and former have to be sets of strings. The affiliations part of a profile is actually map containing both current- and former affiliations. This is defined as the spec:</p>

<pre><code class="language-clojure">(s/def ::affiliations (s/keys :req [::current-affiliations] :opt [::former-affiliations]) )
</code></pre>

<p>which makes it requirement for affiliations to contain current-affiliations, but any former affiliations are optional.</p>

<p>For checking whether Spider-Man has a valid profile we can use the <code>s/valid?</code> function again. We use the following code to do just that:</p>

<pre><code class="language-clj">    (let [spider-man-affiliations (:spider-man-spec.core/affiliations spider-man-profile)]
      (s/valid? :spider-man-spec.core/affiliations spider-man-affiliations))
</code></pre>

<p>The <code>let</code> form is new here, but what it essentially does is deconstructing the while <code>spider-man-profile</code> and associating its affiliations temporarily the <code>spider-man-affiliations</code>. This allows us to use a shorthand when calling functions, instead of writing out everything in a single line.</p>

<p>While this value is also valid according to the spec, as the spec and the value we are checking gets more complex, it could also be useful to gather the exact value that has passed the spec. In such cases we can use <code>s/conform</code> to gather these. The call:</p>

<pre><code class="language-clj">(s/conform :spider-man-spec.core/affiliations spider-man-affiliations)
</code></pre>

<p>Returns the map:</p>

<pre><code class="language-clj">#:spider-man-spec.core{:current-affiliations #{&quot;Avengers&quot;}, :former-affiliations #{&quot;The Outlaws&quot; &quot;Secret Defenders&quot; &quot;New Fantastic Four&quot;}}
</code></pre>

<p>Note that this is a namespaced map, which is a feature that allows us to refer to the keywords inside a map more efficiently, instead of writing them all out in each case.</p>

<p>The final aspect of each profile, the power grid, is also something that can be given a spec. Each of the powers can only take a whole number value from 1 until 7. We can specify this with the follow spec:</p>

<pre><code class="language-clj">(s/def ::power-value (s/and pos-int? #(&gt;= % 1) #(&lt;= % 7)))

(s/def ::durability ::power-value )
(s/def ::energy ::power-value )
(s/def ::fighting ::power-value )
(s/def ::intelligence ::power-value )
(s/def ::speed ::power-value )
(s/def ::strength ::power-value )
</code></pre>

<p>Note that we use the function <code>s/and</code> to combine three specs: that the value should be a positive integer, greater than or equal to 1 and less or equal to 7. Such a combined spec can then be (re-)used like any other.</p>

<p>We can combine all the previous specs together to specify a profile:</p>

<pre><code class="language-clj">(s/def ::profile (s/keys :req [::name ::real-name ::identity ::affiliations ::power-grid] ) )
</code></pre>

<p>For this spec, both Spider-Man and Vulture are valid profiles. However, this is a problem, as it does not allow us to differentiate between a hero and a villain. Of course we do not want to get Vulture get into the same places as Spider-Man can. We must fight him, much like Spider-Man, but in our own way: by creating a spec for which the Spider-Man profile is a valid value, but not that of Vulture.</p>


<figure>
    
        <img src="/img/post/2018-04/spec-stacular-spider-man/spider-man-vs-vulture.jpg" />
    
    
    <figcaption>
        <h4>Spider-Man vs Vulture Â© Marvel Entertainment</h4>
        
    </figcaption>
    
</figure>


<p>While we can make a separate requirement that only persons with the name &ldquo;Spider-Man&rdquo; can fulfill our new &ldquo;hero-spec&rdquo; this might be too restrictive. Instead we are going to spec an Avenger profile, so Spider-Man and all his friends can join in, while villains such as Vulture are kept out.</p>

<p>The requirement for an Avenger in our system, is that any-one with the current affiliation of <code>&quot;Avengers&quot;</code> is an avenger. We can describe this requirement as a spec, using a function defined for this:</p>

<pre><code class="language-clj">(defn is-avenger? [profile]
  (contains? (::current-affiliations (::affiliations profile) ) &quot;Avengers&quot;)
  )

(s/def ::avenger-profile (s/and ::profile is-avenger? ) )
</code></pre>

<p>Now we can check whether a profile is a valid Avenger, which will be true for Spider-Man but not for Vulture. Finally, we can get rid of this villain that showed up in our tutorial. In addition, this spec will also make sure that all current members of the Avengers be valid, so Spider-Man can fight freely alongside of them.</p>


<figure>
    
        <img src="/img/post/2018-04/spec-stacular-spider-man/spider-man-avengers.jpg" />
    
    
    <figcaption>
        <h4>Our spec answers the question posed in this cover: Spider-Man is indeed an Avenger Â© Marvel Entertainment</h4>
        
    </figcaption>
    
</figure>


<p>So there we have it, a brief look at using the spec library to validate data. There are many things that I have not touched, such as the ability to generate values based on the Spec, other ways to compose a spec, etc.</p>

<p>Nonetheless I hope this article gives a solid introduction, and maybe an interest to using the spec library, even if one does not have a Clojure or even a heavy programming background. The source code snippets are available at: <a href="https://github.com/newres/spider-man-spec" target="_blank">Spider-Man-Spec</a>.</p>

<p>If you have a data validation problem, by all means take a swing at it with the Spec library. I am convinced that the results you will get will be nothing short of spectacular.</p>

    </div>

    


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="/tags/clojure">Clojure</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/clojure.spec">clojure.spec</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/knowledge-representation">knowledge representation</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/software-contracts">software contracts</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/specs">specs</a>
  
</div>




    
    
    <div class="article-widget">
      <div class="hr-light"></div>
      <h3>Related</h3>
      <ul>
        
        <li><a href="/post/art-of-choosing-language/">The Art of Choosing a Programming Language</a></li>
        
        <li><a href="/post/interlinked-data/">Data Interlinked</a></li>
        
        <li><a href="/post/trouble-with-triples/">The Trouble with Triples</a></li>
        
        <li><a href="/post/introduction/">Introduction</a></li>
        
      </ul>
    </div>
    

    

    


  </div>
</article>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Newres Al Haider &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/clojure.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/lisp.min.js"></script>
      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

